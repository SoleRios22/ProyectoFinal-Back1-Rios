<h1>{{product.title}}</h1>
<p>{{product.description}}</p>
<p>Precio: ${{product.price}}</p>
<p>Categoria: {{product.category}}</p>
<p>Stock: {{product.stock}}</p>
<button id="addBtn" data-id="{{product._id}}">Agregar al carrito</button>

<script>
  document.getElementById("addBtn").addEventListener("click", async (e) => {
    const pid = e.target.dataset.id;
    // aqui asumimos un carrito ya creado. Puedes crear uno usando POST /api/carts
    const cartId = localStorage.getItem("cartId");
    if (!cartId) {
      const resp = await fetch('/api/carts', { method: 'POST' });
      const cart = await resp.json();
      localStorage.setItem("cartId", cart._id || cart.id || cart.id);
    }
    const cid = localStorage.getItem("cartId");
    await fetch(`/api/carts/${cid}/product/${pid}`, { method: 'POST' });
    alert('Producto agregado al carrito');
  });
</script>
